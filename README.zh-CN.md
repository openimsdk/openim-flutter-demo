<p align="center">
    <a href="https://openim.io">
        <img src="./docs/images/logo.jpg" width="60%" height="30%"/>
    </a>
</p>

# OpenIM Flutter ğŸ’¬ğŸ’»

<p>
  <a href="https://docs.openim.io/">OpenIM Docs</a>
  â€¢
  <a href="https://github.com/openimsdk/open-im-server">OpenIM Server</a>
  â€¢
  <a href="https://github.com/openimsdk/open-im-sdk-flutter">openim-sdk-flutter</a>
  â€¢
  <a href="https://github.com/openimsdk/openim-sdk-core">openim-sdk-core</a>
</p>
OpenIM ä¸ºå¼€å‘è€…æä¾›å¼€æºå³æ—¶é€šè®¯ SDKï¼Œä½œä¸º Twilioã€Sendbird ç­‰äº‘æœåŠ¡çš„æ›¿ä»£æ–¹æ¡ˆã€‚å€ŸåŠ© OpenIMï¼Œå¼€å‘è€…å¯ä»¥æ„å»ºå®‰å…¨å¯é çš„å³æ—¶é€šè®¯åº”ç”¨ï¼Œå¦‚ WeChatã€Zoomã€Slack ç­‰ã€‚

æœ¬ä»“åº“åŸºäºå¼€æºç‰ˆ OpenIM SDK å¼€å‘ï¼Œæä¾›äº†ä¸€æ¬¾åŸºäº Flutter çš„å³æ—¶é€šè®¯åº”ç”¨ã€‚æ‚¨å¯ä»¥ä½¿ç”¨æ­¤åº”ç”¨ç¨‹åºä½œä¸º OpenIM SDK çš„å‚è€ƒå®ç°ã€‚

<p align="center">
    <img src="./docs/images/preveiw1.zh-CN.jpeg" alt="é¢„è§ˆå›¾" width="32%"/>
    <span style="display: inline-block; width: 16px;"></span>
    <img src="./docs/images/preveiw2.zh-CN.jpeg" alt="é¢„è§ˆå›¾" width="32%"/>
</p>

## æˆæƒè®¸å¯ :page_facing_up:

æœ¬ä»“åº“é‡‡ç”¨ GNU Affero é€šç”¨å…¬å…±è®¸å¯è¯ç¬¬ 3 ç‰ˆ (AGPL-3.0) è¿›è¡Œè®¸å¯ï¼Œå¹¶å—ä»¥ä¸‹é™„åŠ æ¡æ¬¾çš„çº¦æŸã€‚**ä¸å…è®¸ç”¨äºå•†ä¸šç”¨é€”**ã€‚è¯¦æƒ…è¯·å‚é˜… [æ­¤å¤„](./LICENSE)ã€‚

## å¼€å‘ç¯å¢ƒ

åœ¨å¼€å§‹å¼€å‘ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨çš„ç³»ç»Ÿå·²å®‰è£…ä»¥ä¸‹è½¯ä»¶ï¼š

- **æ“ä½œç³»ç»Ÿ**ï¼šmacOS 14.6 æˆ–æ›´é«˜ç‰ˆæœ¬
- **Flutter**ï¼šç‰ˆæœ¬ 3.24.5ï¼ˆæ ¹æ®å®˜ç½‘æ­¥éª¤è¿›è¡Œ[å®‰è£…](https://docs.flutter.cn/get-started/install)ï¼‰
- **Git**ï¼šç”¨äºä»£ç ç‰ˆæœ¬æ§åˆ¶

åŒæ—¶ï¼Œæ‚¨éœ€è¦ç¡®ä¿å·²ç»[éƒ¨ç½²](https://docs.openim.io/zh-Hans/guides/gettingStarted/dockerCompose)äº†æœ€æ–°ç‰ˆæœ¬çš„ OpenIM Serverã€‚æ¥ä¸‹æ¥ï¼Œæ‚¨å¯ä»¥ç¼–è¯‘é¡¹ç›®å¹¶è¿æ¥è‡ªå·±çš„æœåŠ¡ç«¯è¿›è¡Œæµ‹è¯•ã€‚

## è¿è¡Œç¯å¢ƒ

æœ¬åº”ç”¨æ”¯æŒä»¥ä¸‹æ“ä½œç³»ç»Ÿç‰ˆæœ¬ï¼š

| æ“ä½œç³»ç»Ÿ | ç‰ˆæœ¬              | çŠ¶æ€ |
| --------------- | ----------------- | ---- |
| **iOS**      | 13.0 åŠä»¥ä¸Š         | âœ…   |
| **Android**     | minSdkVersion 24 | âœ…   |

### è¯´æ˜

- **Flutter**ï¼šç¡®ä¿æ‚¨çš„ç‰ˆæœ¬ç¬¦åˆè¦æ±‚ï¼Œä»¥é¿å…ä¾èµ–é—®é¢˜ã€‚

## å¿«é€Ÿå¼€å§‹

æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è®¾ç½®æœ¬åœ°å¼€å‘ç¯å¢ƒï¼š

1. æ‹‰å–ä»£ç 

```bash
  git clone https://github.com/openimsdk/openim-flutter-demo.git
  cd openim-flutter-demo
```

2. å®‰è£…ä¾èµ–

```bash
  flutter clean 
  flutter pub get
```

3. ä¿®æ”¹é…ç½®

  > å¦‚æœæ²¡æœ‰ä¿®æ”¹è¿‡æœåŠ¡ç«¯é»˜è®¤ç«¯å£ï¼Œåˆ™åªéœ€è¦ä¿®æ”¹[_host](https://github.com/openimsdk/open-im-flutter-demo/blob/a309f25fdbc143e49d5ca852171ce57970871c85/openim_common/lib/src/config.dart#L59)ä¸ºæ‚¨çš„æœåŠ¡å™¨ ip å³å¯ã€‚

  ```dart
    static const _host = "your-server-ip or your-domain";
  ```

4. é€šè¿‡ç»ˆç«¯æ‰§è¡Œ `flutter run` æˆ–è€…IDEçš„å¯åŠ¨èœå•æ¥è¿è¡ŒiOS/Androidåº”ç”¨ç¨‹åºã€‚

5. å¼€å§‹å¼€å‘æµ‹è¯•ï¼ ğŸ‰

## éŸ³è§†é¢‘é€šè¯

å¼€æºç‰ˆæ”¯æŒä¸€å¯¹ä¸€éŸ³è§†é¢‘é€šè¯ï¼Œå¹¶ä¸”éœ€è¦å…ˆéƒ¨ç½²å¹¶é…ç½®[æœåŠ¡ç«¯](https://github.com/openimsdk/chat/blob/main/HOW_TO_SETUP_LIVEKIT_SERVER.md)ã€‚å¤šäººéŸ³è§†é¢‘é€šè¯ã€è§†é¢‘ä¼šè®®è¯·è”ç³»é‚®ç®± [contact@openim.io](mailto:contact@openim.io)

## æ„å»º ğŸš€

> è¯¥é¡¹ç›®å…è®¸åˆ†åˆ«æ„å»º iOS åº”ç”¨ç¨‹åºå’Œ Android åº”ç”¨ç¨‹åºï¼Œä½†åœ¨æ„å»ºè¿‡ç¨‹ä¸­ä¼šæœ‰ä¸€äº›å·®å¼‚ã€‚

   - iOS:
     ```bash
     flutter build ipa
     ```
   - Android:
     ```bash
     flutter build apk
     ```

 æ„å»ºç»“æœå°†ä½äº `build`  ç›®å½•ä¸‹ã€‚

## åŠŸèƒ½åˆ—è¡¨

### è¯´æ˜

| åŠŸèƒ½æ¨¡å—           | åŠŸèƒ½é¡¹                                                    | çŠ¶æ€ |
| ------------------ | --------------------------------------------------------- | ---- |
| **è´¦å·åŠŸèƒ½**       | æ‰‹æœºå·æ³¨å†Œ\é‚®ç®±æ³¨å†Œ\éªŒè¯ç ç™»å½•                            | âœ…   |
|                    | ä¸ªäººä¿¡æ¯æŸ¥çœ‹\ä¿®æ”¹                                         | âœ…   |
|                    | å¤šè¯­è¨€è®¾ç½®                                                | âœ…   |
|                    | ä¿®æ”¹å¯†ç \å¿˜è®°å¯†ç                                          | âœ…   |
| **å¥½å‹åŠŸèƒ½**       | æŸ¥æ‰¾\ç”³è¯·\æœç´¢\æ·»åŠ \åˆ é™¤å¥½å‹                              | âœ…   |
|                    | åŒæ„\æ‹’ç»å¥½å‹ç”³è¯·                                         | âœ…   |
|                    | å¥½å‹å¤‡æ³¨                                                  | âœ…   |
|                    | æ˜¯å¦å…è®¸æ·»åŠ å¥½å‹                                          | âœ…   |
|                    | å¥½å‹åˆ—è¡¨\å¥½å‹èµ„æ–™å®æ—¶åŒæ­¥                                 | âœ…   |
| **é»‘åå•åŠŸèƒ½**     | é™åˆ¶æ¶ˆæ¯                                                  | âœ…   |
|                    | é»‘åå•åˆ—è¡¨å®æ—¶åŒæ­¥                                        | âœ…   |
|                    | æ·»åŠ \ç§»å‡ºé»‘åå•                                           | âœ…   |
| **ç¾¤ç»„åŠŸèƒ½**       | åˆ›å»º\è§£æ•£ç¾¤ç»„                                             | âœ…   |
|                    | ç”³è¯·åŠ ç¾¤\é‚€è¯·åŠ ç¾¤\é€€å‡ºç¾¤ç»„\ç§»é™¤ç¾¤æˆå‘˜                     | âœ…   |
|                    | ç¾¤å/ç¾¤å¤´åƒæ›´æ”¹/ç¾¤èµ„æ–™å˜æ›´é€šçŸ¥å’Œå®æ—¶åŒæ­¥                  | âœ…   |
|                    | ç¾¤æˆå‘˜é‚€è¯·è¿›ç¾¤                                            | âœ…   |
|                    | ç¾¤ä¸»è½¬è®©                                                  | âœ…   |
|                    | ç¾¤ä¸»ã€ç®¡ç†å‘˜åŒæ„è¿›ç¾¤ç”³è¯·                                  | âœ…   |
|                    | æœç´¢ç¾¤æˆå‘˜                                                | âœ…   |
| **æ¶ˆæ¯åŠŸèƒ½**       | ç¦»çº¿æ¶ˆæ¯                                                  | âœ…   |
|                    | æ¼«æ¸¸æ¶ˆæ¯                                                  | âœ…   |
|                    | å¤šç«¯æ¶ˆæ¯                                                  | âœ…   |
|                    | å†å²æ¶ˆæ¯                                                  | âœ…   |
|                    | æ¶ˆæ¯åˆ é™¤                                                  | âœ…   |
|                    | æ¶ˆæ¯æ¸…ç©º                                                  | âœ…   |
|                    | æ¶ˆæ¯å¤åˆ¶                                                  | âœ…   |
|                    | å•èŠæ­£åœ¨è¾“å…¥                                              | âœ…   |
|                    | æ–°æ¶ˆæ¯å‹¿æ‰°                                                | âœ…   |
|                    | æ¸…ç©ºèŠå¤©è®°å½•                                              | âœ…   |
|                    | æ–°æˆå‘˜æŸ¥çœ‹ç¾¤èŠå†å²æ¶ˆæ¯                                    | âœ…   |
|                    | æ–°æ¶ˆæ¯æç¤º                                                | âœ…   |
|                    | æ–‡æœ¬æ¶ˆæ¯                                                  | âœ…   |
|                    | å›¾ç‰‡æ¶ˆæ¯                                                  | âœ…   |
|                    | è§†é¢‘æ¶ˆæ¯                                                  | âœ…   |
|                    | è¡¨æƒ…æ¶ˆæ¯                                                  | âœ…   |
|                    | æ–‡ä»¶æ¶ˆæ¯                                                  | âœ…   |
|                    | è¯­éŸ³æ¶ˆæ¯                                                  | âœ…   |
|                    | åç‰‡æ¶ˆæ¯                                                  | âœ…   |
|                    | åœ°ç†ä½ç½®æ¶ˆæ¯                                              | âœ…   |
|                    | è‡ªå®šä¹‰æ¶ˆæ¯                                                | âœ…   |
| **ä¼šè¯åŠŸèƒ½**       | ç½®é¡¶ä¼šè¯                                                  | âœ…   |
|                    | ä¼šè¯å·²è¯»                                                  | âœ…   |
|                    | ä¼šè¯å…æ‰“æ‰°                                                | âœ…   |
| **REST API**       | è®¤è¯ç®¡ç†                                                  | âœ…   |
|                    | ç”¨æˆ·ç®¡ç†                                                  | âœ…   |
|                    | å…³ç³»é“¾ç®¡ç†                                                | âœ…   |
|                    | ç¾¤ç»„ç®¡ç†                                                  | âœ…   |
|                    | ä¼šè¯ç®¡ç†                                                  | âœ…   |
|                    | æ¶ˆæ¯ç®¡ç†                                                  | âœ…   |
| **Webhook**        | ç¾¤ç»„å›è°ƒ                                                  | âœ…   |
|                    | æ¶ˆæ¯å›è°ƒ                                                  | âœ…   |
|                    | æ¨é€å›è°ƒ                                                  | âœ…   |
|                    | å…³ç³»é“¾å›è°ƒ                                                | âœ…   |
|                    | ç”¨æˆ·å›è°ƒ                                                  | âœ…   |
| **å®¹é‡å’Œæ€§èƒ½**     | 1 ä¸‡å¥½å‹                                                  | âœ…   |
|                    | 10 ä¸‡äººå¤§ç¾¤                                               | âœ…   |
|                    | ç§’çº§åŒæ­¥                                                  | âœ…   |
|                    | é›†ç¾¤éƒ¨ç½²                                                  | âœ…   |
|                    | äº’è¸¢ç­–ç•¥                                                  |      |
| **åœ¨çº¿çŠ¶æ€**       | æ‰€æœ‰å¹³å°ä¸äº’è¸¢                                            | âœ…   |
|                    | æ¯ä¸ªå¹³å°å„åªèƒ½ç™»å½•ä¸€ä¸ªè®¾å¤‡                                | âœ…   |
|                    | PC ç«¯ã€ç§»åŠ¨ç«¯ã€Pad ç«¯ã€Web ç«¯ã€å°ç¨‹åºç«¯å„åªèƒ½ç™»å½•ä¸€ä¸ªè®¾å¤‡ | âœ…   |
|                    | PC ç«¯ä¸äº’è¸¢ï¼Œå…¶ä»–å¹³å°æ€»è®¡ä¸€ä¸ªè®¾å¤‡                         | âœ…   |
| **éŸ³è§†é¢‘é€šè¯**     | ä¸€å¯¹ä¸€éŸ³è§†é¢‘é€šè¯                                          | âœ…   |
| **æ–‡ä»¶ç±»å¯¹è±¡å­˜å‚¨** | æ”¯æŒç§æœ‰åŒ–éƒ¨ç½² minio                                      | âœ…   |
|                    | æ”¯æŒ COSã€OSSã€Kodoã€S3 å…¬æœ‰äº‘                            | âœ…   |
| **æ¨é€**           | æ¶ˆæ¯åœ¨çº¿å®æ—¶æ¨é€                                          | âœ…   |
|                    | æ¶ˆæ¯ç¦»çº¿æ¨é€ï¼Œæ”¯æŒä¸ªæ¨ï¼ŒFirebase                          | âœ…   |

æ›´å¤šé«˜çº§åŠŸèƒ½ã€éŸ³è§†é¢‘é€šè¯ã€è§†é¢‘ä¼šè®® è¯·è”ç³»é‚®ç®± [contact@openim.io](mailto:contact@openim.io)

## åŠ å…¥ç¤¾åŒº :busts_in_silhouette:

- ğŸš€ [åŠ å…¥æˆ‘ä»¬çš„ Slack ç¤¾åŒº](https://join.slack.com/t/openimsdk/shared_invite/zt-22720d66b-o_FvKxMTGXtcnnnHiMqe9Q)
- :eyes: [åŠ å…¥æˆ‘ä»¬çš„å¾®ä¿¡ç¾¤](https://openim-1253691595.cos.ap-nanjing.myqcloud.com/WechatIMG20.jpeg)

## å¸¸è§é—®é¢˜

##### 1. æ˜¯å¦æ”¯æŒå¤šè¯­è¨€ï¼Ÿ
ç­”ï¼šæ”¯æŒï¼Œé»˜è®¤è·Ÿéšç³»ç»Ÿè¯­è¨€ã€‚

##### 2. æ”¯æŒå“ªäº›å¹³å°ï¼Ÿ
ç­”ï¼šç›®å‰ Demo æ”¯æŒ Android å’Œ iOSã€‚

##### 3. Android å®‰è£…åŒ…çš„ debug ç‰ˆæœ¬å¯ä»¥è¿è¡Œï¼Œä½† release å¯åŠ¨æ˜¯ç™½å±ï¼Ÿ
ç­”ï¼šFlutter çš„ release åŒ…é»˜è®¤ä¼šè¿›è¡Œæ··æ·†ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```bash
  flutter build release --no-shrink
```

å¦‚æœæ­¤å‘½ä»¤æ— æ•ˆï¼Œå¯ä»¥åœ¨ android/app/build.gradle æ–‡ä»¶çš„ release é…ç½®ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š

```bash
  release {
      minifyEnabled false
      useProguard false
      shrinkResources false
  }
```

##### 4. å¦‚æœä»£ç å¿…é¡»æ··æ·†è¯¥æ€ä¹ˆåŠï¼Ÿ
ç­”ï¼šåœ¨æ··æ·†è§„åˆ™ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š

```bash
  -keep class io.openim.**{*;}
  -keep class open_im_sdk.**{*;}
  -keep class open_im_sdk_callback.**{*;}
```

##### 5. Android å®‰è£…åŒ…æ— æ³•å®‰è£…åœ¨æ¨¡æ‹Ÿå™¨ä¸Šï¼Ÿ
ç­”ï¼šç”±äº Demo ç§»é™¤äº†ä¸€äº› CPU æ¶æ„ï¼Œå¦‚æœéœ€è¦åœ¨æ¨¡æ‹Ÿå™¨ä¸Šè¿è¡Œï¼Œè¯·åœ¨ android/build.gradle é…ç½®ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š

```bash
  ndk {
      abiFilters "armeabi-v7a",  "x86"
  }
```

##### 6. iOS è¿è¡Œ/æ‰“åŒ… release åŒ…æ—¶æŠ¥é”™ï¼Ÿ
ç­”ï¼šè¯·å°† CPU æ¶æ„è®¾ç½®ä¸º arm64ï¼Œç„¶åæŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

```bash
  æ‰§è¡Œ flutter clean
  æ‰§è¡Œ flutter pub get
  cd ios/
  rm -f Podfile.lock
  rm -rf Pods
  æ‰§è¡Œ pod install
  è¿æ¥çœŸæœºåè¿è¡Œ Archiveã€‚
```
![ios cpu](https://user-images.githubusercontent.com/7018230/155913400-6231329a-aee9-4082-8d24-a25baad55261.png)

##### 7. iOS æœ€ä½è¿è¡Œç‰ˆæœ¬æ˜¯å¤šå°‘ï¼Ÿ
ç­”ï¼š13.0

##### 8. åœ°å›¾ä¸ºä»€ä¹ˆä¸èƒ½ä½¿ç”¨ï¼Ÿ

ç­”ï¼šéœ€è¦é…ç½®å¯¹åº”çš„AMap keyï¼Œå…·ä½“è¯·å‚è€ƒ[AMapæ–‡æ¡£](https://lbs.amap.com/)ï¼Œåœ¨ä»£ç ä¸­ä¿®æ”¹å¦‚ä¸‹keyï¼š

- [webKey](https://github.com/openimsdk/openim-flutter-demo/blob/5720a10a31a0a9bc5319775f9f4da83d6996dbfe/openim_common/lib/src/config.dart#L49)
- [webServerKey](https://github.com/openimsdk/openim-flutter-demo/blob/5720a10a31a0a9bc5319775f9f4da83d6996dbfe/openim_common/lib/src/config.dart#L50)

å®Œæˆé…ç½®åå³å¯å¯ç”¨åœ°å›¾åŠŸèƒ½ã€‚

##### 9. ç¦»çº¿æ¨é€ä¸ºä»€ä¹ˆä¸èƒ½ä½¿ç”¨ï¼Ÿ

###### å®¢æˆ·ç«¯é…ç½®

###### 1. ä¸­å›½å¤§é™†åœ°åŒºä½¿ç”¨ä¸ªæ¨ï¼ˆGetuiï¼‰

åœ¨ä»£ç ä¸­æ‰¾åˆ°ä»¥ä¸‹æ–‡ä»¶å¹¶ä¿®æ”¹å¯¹åº”çš„iOSä¾§ä¸ªæ¨ Keyï¼š

- [push_controller.dart](openim_common/lib/src/controller/push_controller.dart)

ä¿®æ”¹ Android é…ç½®ï¼š

- [build.gradle](android/app/build.gradle)

###### 2. æµ·å¤–åœ°åŒºä½¿ç”¨ FCMï¼ˆFirebase Cloud Messagingï¼‰

 æ ¹æ® FCM çš„é›†æˆæŒ‡å—ï¼Œæ›¿æ¢ä»¥ä¸‹æ–‡ä»¶ï¼š

- [google-services.json](android/app/google-services.json)ï¼ˆAndroid å¹³å°ï¼‰
- [GoogleService-Info.plist](ios/Runner/GoogleService-Info.plist)ï¼ˆiOS å¹³å°ï¼‰
- [firebase_options.dart](openim_common/lib/src/controller/firebase_options.dart)ï¼ˆDart é¡¹ç›®ä¸­çš„ Firebase é…ç½®ï¼‰

###### æœåŠ¡ç«¯é…ç½®

åœ¨æœåŠ¡ç«¯ä¿®æ”¹æ¨é€ç›¸å…³é…ç½®æ–‡ä»¶ï¼š

- [openim-push.yml](https://github.com/openimsdk/open-im-server/blob/main/config/openim-push.yml)

æ ¹æ®å®é™…éœ€æ±‚ï¼Œå®Œæˆå¯¹åº”çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯é…ç½®åå³å¯å¯ç”¨ç¦»çº¿æ¨é€åŠŸèƒ½ã€‚
